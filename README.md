# Cursor Agent Rules (Antigravity)

Cursorエディタを **「自律型AIエージェント」** に進化させるルールセットです。
チャットでコマンドを入力するだけで、AIが設計・実装・監査を自動で行います。

**エンジニア経験がなくても大丈夫。** このルールがあなたの「副操縦士」になります。

---

## 🎯 これは何？

「AIにコードを書いてもらったけど、本当に大丈夫？」
「セキュリティとか品質とか、何をチェックすればいいかわからない...」

**このルールセットがあれば、AIが勝手にチェックしてくれます。**

- ✅ セキュリティの穴がないか自動監査
- ✅ 設計→実装→テストの流れを自動ナビゲート
- ✅ 「次に何をすべきか」を常に教えてくれる

---

## 📥 インストール（3ステップで完了）

### ステップ1: ダウンロード
このリポジトリの **[Releases](../../releases)** から最新のZipをダウンロード。
または、リポジトリをそのままクローン。

### ステップ2: 配置
解凍したフォルダ内の `.cursor` フォルダを、**あなたのプロジェクトのルート**にコピー。

```
your-project/          ← あなたのプロジェクト
├── .cursor/           ← これをコピー！
│   ├── rules/
│   └── templates/
├── src/
└── ...
```

### ステップ3: 再起動
Cursorを **完全に閉じて、もう一度開く**。
これでルールが有効になります。

> 💡 **確認方法**: チャットで `@help` と入力してみてください。ナビゲーションが表示されれば成功！

---

## ⚡ 超速チートシート

「今やりたいこと」からコマンドを選んでください。

| 今の状態 | やりたいこと | 魔法のコマンド |
| :--- | :--- | :--- |
| 🆕 **新規** | 「こんな機能ほしいな...」 | `@spec` |
| 📐 **設計** | 「仕様は決まった！設計しよう」 | `@design` |
| 🔨 **実装** | 「設計できた！作るぞ！」 | `@impl` |
| 🐛 **バグ** | 「動かない！直して！」 | `@impl` |
| 🧹 **掃除** | 「コードを綺麗にしたい」 | `@refactor` |
| 🚢 **出荷** | 「リリースしていい？」 | `@ship` |
| 🛡️ **監査** | 「セキュリティ大丈夫？」 | `@audit` |
| ❓ **迷子** | 「次なにすればいい？」 | `@help` |
| 🔄 **再開** | 「昨日の続きから」 | `@onboard` |
| 🔚 **終了** | 「今日はここまで！」 | `@wrap-up` |

---

## 🚀 基本の流れ（ゴールデンサイクル）

開発はこの順番で進めます。**全部コマンドを入力するだけ。**

```
@spec → @design → @impl → @test → @ship
```

| 順番 | コマンド | 何をするの？ |
| :---: | :--- | :--- |
| 1 | `@spec` | 何を作るか決める。「提案して」と言えばAIが全部書いてくれる |
| 2 | `@design` | DB・API・画面構成を設計。「全部やって」でOK |
| 3 | `@impl` | 設計通りにコーディング。セキュリティも自動で考慮 |
| 4 | `@test` | テストを実行。なければ勝手に作ってくれる |
| 5 | `@ship` | **最終関門**。セキュリティ・品質を全チェック |

> 💡 **ポイント**: いきなり `@impl` しない！必ず `@design` で設計図を作ってから。

---

## 💬 コピペで使えるテンプレート

AIへの指示に迷ったら、以下をコピーして使ってください。

### 🆕 新機能を作りたいとき

```
@spec
# 新機能の要望
「タスク管理機能」を追加したいです。
ユーザーがタスクを追加・編集・削除できるようにしたい。
詳細な要件は、一般的なWebアプリの構成で**全て提案してください**。
```

### 🐛 バグを直したいとき

```
@impl
# バグ修正依頼
以下の事象が発生しています。原因を調査して修正してください。
- 事象: ログイン画面で「送信」を押しても反応がない
- 期待値: ダッシュボードに遷移すること
```

### 🧹 コードを綺麗にしたいとき

```
@refactor
対象: src/features/auth/AuthService.ts

上記のファイルが読みづらいです。
機能は一切変えずに、可読性を上げるためにリファクタリングしてください。
```

### 🚢 リリース前の最終確認

```
@ship
実装が終わりました。
リリースしても大丈夫か、全ての監査を実行してください。
問題があれば、修正案もセットで教えてください。
```

### 🔄 昨日の続きから再開

```
@onboard
昨日の続きから作業を再開します。
現在の状況と、次にやるべきことを教えてください。
```

---

## 📋 全コマンド一覧

### 開発フロー
| コマンド | 説明 |
| :--- | :--- |
| `@spec` | 要件定義。「何を作るか」を決める |
| `@design` | 設計。DB/API/画面構成を決める |
| `@impl` | 実装。コードを書く |
| `@test` | テスト実行・自動生成 |
| `@review` | コードレビュー（自動修正付き） |
| `@ship` | 出荷判定。全項目チェック |

### 監査・品質
| コマンド | 説明 |
| :--- | :--- |
| `@audit` | 厳格セキュリティ監査 |
| `@sec` | セキュリティ＆ライセンスチェック |
| `@perf` | パフォーマンス監査 |
| `@qa` | UX・SEO・データ整合性チェック |

### ユーティリティ
| コマンド | 説明 |
| :--- | :--- |
| `@help` | 困ったときのナビゲーション |
| `@init` | プロジェクト初期化 |
| `@onboard` | プロジェクト再開・状況把握 |
| `@wrap-up` | セッション終了・状態保存 |
| `@refactor` | 安全なリファクタリング |
| `@consult` | AIによる改善提案 |
| `@sync` | プロジェクト整合性チェック |

---

## 🔄 賢い使い方のコツ

### 1. チャットが重くなったらリセット

会話が長くなるとAIの動作が遅くなります。
**「1つの機能＝1つのチャット」** で運用しましょう。

```
作業完了 → @wrap-up → 新しいチャット → @onboard
```

### 2. 迷ったら `@help`

何をすればいいかわからなくなったら、とりあえず `@help` と入力。
AIが状況を見て、次のアクションを提案してくれます。

### 3. いきなりコードを書かせない

「ログイン機能作って」といきなり言うと、設計なしでコードが出てきます。
**必ず `@design` で設計図を作ってから** `@impl` しましょう。

---

## ⚠️ 絶対に守るべき3つのルール

1. **迷ったら `@design`** - いきなりコードを書かせない。設計図を作る。
2. **出荷前は `@ship`** - 人間がチェックする前に、AIの監査を通す。
3. **チャットは軽く** - 長くなったら `@wrap-up` → 新規チャット。

---

## 🛡️ セキュリティ機能

このルールセットは、以下のセキュリティ機能を**自動で**適用します。

| 機能 | 説明 |
| :--- | :--- |
| **RLS必須** | データベース操作時、アクセス制御を強制 |
| **脅威モデリング** | 実装前に「攻撃者の視点」でリスク分析 |
| **秘密情報チェック** | APIキー等のハードコードを検出 |
| **監査ログ** | 誰が何をしたかを追跡可能に |

---

## 📁 ファイル構成

```
.cursor/
├── rules/                  # AIへの指示ルール
│   ├── 000-core.mdc       # 基本ルール（常時適用）
│   ├── 001-planning.mdc   # 計画フェーズ
│   ├── 002-coding.mdc     # 実装フェーズ
│   ├── 003-audit.mdc      # 監査フェーズ
│   └── workflow-*.mdc     # 各コマンドの動作定義
└── templates/              # ドキュメントの雛形
    ├── requirements.md    # 要件定義テンプレート
    ├── architecture.md    # 設計テンプレート
    ├── schema.md          # DB設計テンプレート
    └── api.md             # API設計テンプレート
```

---

## ❓ よくある質問

### Q: ルールが効いているか確認したい
チャットで `@help` と入力してください。ナビゲーションが表示されれば有効です。

### Q: コマンドを打っても反応がない
Cursorを完全に再起動してください。それでもダメなら `.cursor/rules/` フォルダがプロジェクトルートにあるか確認。

### Q: 他のプロジェクトでも使いたい
`.cursor` フォルダをコピーするだけでOK。プロジェクトごとにカスタマイズも可能です。

### Q: チームで共有したい
`.cursor` フォルダをGitリポジトリに含めて共有してください。全員が同じルールで開発できます。

---

## 📜 ライセンス

MIT License - 自由に使ってください。

---

## 🙏 貢献

改善案・バグ報告は [Issues](../../issues) へ。
プルリクエストも歓迎です！
